<div class="checkout-page">
  <form
    [formGroup]="checkoutForm"
    (ngSubmit)="onSubmit()"
    class="checkout-form"
  >
    <h1>Checkout</h1>
    <div class="form-body">
      <div class="form-item">
        <label for="name" class="form-label">Name</label>
        <input
          type="text"
          id="name"
          formControlName="name"
          class="form-input"
          required
        />
        <div
          *ngIf="
            checkoutForm.get('name')?.invalid &&
            (checkoutForm.get('name')?.dirty ||
              checkoutForm.get('name')?.touched)
          "
          class="text-danger"
        >
          <div *ngIf="checkoutForm.get('name')?.errors?.['required']">
            Name is required.
          </div>
          <div *ngIf="checkoutForm.get('name')?.errors?.['invalidName']">
            Only letters a-z & A-Z allowed.
          </div>
        </div>
      </div>
      <div class="form-item">
        <label for="address" class="form-label">Address</label>
        <input
          type="text"
          id="name"
          formControlName="address"
          class="form-input"
          required
        />
      </div>
      <div class="form-item">
        <label for="email" class="form-label">Email</label>
        <input
          type="text"
          id="email"
          formControlName="email"
          class="form-input"
          required
        />
      </div>

      <div class="form-item">
        <label for="telephone" class="form-label">Telephone</label>
        <input
          type="text"
          id="telephone"
          formControlName="telephone"
          class="form-input"
          required
        />
        <div
          *ngIf="
            checkoutForm.get('telephone')?.invalid &&
            (checkoutForm.get('telephone')?.dirty ||
              checkoutForm.get('telephone')?.touched)
          "
          class="text-danger"
        >
          <div *ngIf="checkoutForm.get('telephone')?.errors?.['required']">
            Telephone is required.
          </div>
          <div
            *ngIf="checkoutForm.get('telephone')?.errors?.['invalidTelephone']"
          >
            Only "+" sign and numbers 0-9 allowed.
          </div>
        </div>
      </div>
      <div class="submit">
        <button class="submit-btn" (click)="onSubmit()">Confirm order</button>
      </div>
    </div>
  </form>

  <div class="checkout-cart">
    <div *ngIf="cartItems.length > 0">
      <div *ngFor="let item of cartItems" class="checkout-item">
        <img src="{{ item.thumbnail }}" class="checkout-img" />
        <div>
          <h5 class="checkout-title">{{ item.title }}</h5>
        </div>
        <div>
          <p class="checkout-price">
            {{ item.price * item.quantity | currency : "EUR" }}
          </p>
        </div>

        <input
          type="number"
          id="quantity{{ item.id }}"
          [(ngModel)]="item.quantity"
          (change)="updateQuantity(item.id, item.quantity)"
          class="form-input"
          min="1"
        />

        <button class="btn btn-danger" (click)="removeItem(item.id)">
          Remove
        </button>
      </div>
      <div class="price-summary">
        <p>Total price:</p>
        <p class="total-price">
          {{ totalPrice | currency : "EUR" }}
        </p>
      </div>
    </div>

    <div *ngIf="cartItems.length === 0">
      <p>Your cart is empty.</p>
    </div>
  </div>
</div>
